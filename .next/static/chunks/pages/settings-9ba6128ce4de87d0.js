(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{2837:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings",function(){return n(569)}])},1695:function(e,t,n){"use strict";n.d(t,{Y:function(){return r}});var a=n(5893),s=n(7294),l=n(4967),i=n(1163);function r(e){let{children:t}=e,n=(0,i.useRouter)(),[r,o]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{(async()=>{let{data:{user:e}}=await l.O.auth.getUser();e?o(!0):n.replace("/auth")})()},[n]),r)?(0,a.jsx)(a.Fragment,{children:t}):null}},569:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var a=n(5893),s=n(7294),l=n(4967),i=n(1695),r=n(4929);function o(){return(0,a.jsx)(i.Y,{children:(0,a.jsx)(c,{})})}function c(){let{site_name:e,logo_url:t}=(0,r.h)(),[n,i]=(0,s.useState)(e||""),[o,c]=(0,s.useState)(null),[u,d]=(0,s.useState)(t||null),[h,p]=(0,s.useState)(!1),x=(0,s.useRef)(null);async function f(e){let t=e.name.split(".").pop()||"png",n="logos/site-".concat(Date.now(),".").concat(t),a=l.O.storage.from("assets"),{error:s}=await a.upload(n,e,{upsert:!0,contentType:e.type||"image/png"});if(s)throw s;let{data:i}=a.getPublicUrl(n);return i.publicUrl}async function g(){p(!0);try{var e,a;let s=t||null;o&&(s=await f(o));let{data:i}=await l.O.auth.getUser(),r=null!==(a=null==i?void 0:null===(e=i.user)||void 0===e?void 0:e.id)&&void 0!==a?a:null,c={id:1,site_name:n||null,logo_url:s,updated_by:r,updated_at:new Date().toISOString()},{error:u}=await l.O.from("site_settings").upsert(c,{onConflict:"id"});if(u)throw u;window.location.reload()}catch(e){alert((null==e?void 0:e.message)||"Save failed")}finally{p(!1)}}return(0,s.useEffect)(()=>{i(e||"")},[e]),(0,s.useEffect)(()=>{d(t||null)},[t]),(0,a.jsxs)("div",{className:"max-w-xl mx-auto p-6 space-y-6",children:[(0,a.jsx)("h1",{className:"text-xl font-medium text-white/90",children:"Site Settings"}),(0,a.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4 space-y-4",children:[(0,a.jsxs)("label",{className:"block space-y-2",children:[(0,a.jsx)("span",{className:"text-sm text-white/70",children:"Site name"}),(0,a.jsx)("input",{value:n,onChange:e=>i(e.target.value),placeholder:"SIGMET",className:"w-full rounded-xl bg-transparent border border-white/10 px-3 py-2 outline-none placeholder-white/40"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("span",{className:"text-sm text-white/70",children:"Logo"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("input",{ref:x,type:"file",accept:"image/*",className:"hidden",onChange:function(e){var t;let n=null===(t=e.target.files)||void 0===t?void 0:t[0];n&&(c(n),d(URL.createObjectURL(n)))}}),(0,a.jsx)("button",{onClick:()=>{var e;return null===(e=x.current)||void 0===e?void 0:e.click()},className:"h-10 px-4 rounded-xl border border-white/10 bg-white/5 hover:bg-white/10",children:"Choose file"}),u&&(0,a.jsx)("img",{src:u,alt:"Logo preview",className:"h-10 w-10 rounded-lg border border-white/10 object-cover"})]}),(0,a.jsx)("p",{className:"text-xs text-white/50",children:"Recommended: square PNG/SVG, 36–40px height in header."})]}),(0,a.jsx)("div",{className:"pt-2",children:(0,a.jsxs)("button",{onClick:g,disabled:h,className:"relative inline-flex items-center gap-2 rounded-2xl px-5 py-2.5 bg-gradient-to-r from-white to-white/90 text-black shadow-[0_8px_24px_rgba(255,255,255,0.25)] hover:shadow-[0_10px_36px_rgba(255,255,255,0.35)] hover:translate-y-[-1px] active:translate-y-0 transition disabled:opacity-60",children:[h?"Saving…":"Save changes",(0,a.jsx)("span",{className:"absolute inset-0 rounded-2xl ring-1 ring-white/30 pointer-events-none"})]})})]})]})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=2837)}),_N_E=e.O()}]);