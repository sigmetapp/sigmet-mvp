(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{3236:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return a(1237)}])},6044:function(e,t,a){"use strict";var n=a(5893);a(7294);var r=a(1664),s=a.n(r),l=a(1093);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter(Boolean).join(" ")}let o={sm:"text-sm px-3 py-1.5 gap-2",md:"text-sm px-4 py-2 gap-2",lg:"text-base px-5 py-3 gap-2"},c={sm:"h-9 w-9",md:"h-10 w-10",lg:"h-12 w-12"},u={primary:"text-[#0b1220] bg-[linear-gradient(90deg,#00ffc8,#7affc0)] shadow-[0_0_0_0_rgba(0,0,0,0)] hover:shadow-[0_0_24px_0_rgba(122,255,192,0.35)] focus-visible:ring-2 focus-visible:ring-[rgba(122,255,192,0.45)]",secondary:"text-[var(--accent)] border border-[color:var(--accent)]/60 bg-transparent hover:bg-[color:var(--accent)]/10 focus-visible:ring-2 focus-visible:ring-[rgba(122,255,192,0.35)]",ghost:"bg-transparent text-[var(--accent)] hover:text-white hover:[text-shadow:0_0_12px_rgba(122,255,192,0.6)] focus-visible:ring-2 focus-visible:ring-[rgba(122,255,192,0.25)]",icon:"text-[var(--text)]/80 bg-white/0 border border-white/15 hover:bg-white/10 hover:text-white focus-visible:ring-2 focus-visible:ring-[rgba(122,255,192,0.25)]",orange:"text-[#0b1220] bg-[linear-gradient(90deg,#ffd48a,#ff9b4a)] shadow-[0_0_0_0_rgba(0,0,0,0)] hover:shadow-[0_0_24px_0_rgba(255,155,74,0.35)] focus-visible:ring-2 focus-visible:ring-[rgba(255,155,74,0.45)]"};t.Z=function(e){let{variant:t="primary",size:a="md",icon:r,className:d,children:h,ariaLabel:m,href:x,...p}=e,g="icon"===t&&!h,b=i("inline-flex select-none items-center justify-center rounded-xl font-semibold focus-visible:outline-none transition will-change-transform",u[t],g?c[a]:o[a],g?"rounded-full":"rounded-xl",d),w=(0,n.jsxs)(l.E.span,{className:i("inline-flex items-center",g?"":"gap-2"),whileHover:{scale:1.03},whileTap:{scale:.98},children:[r,h&&(0,n.jsx)("span",{children:h})]});if(x){let{href:e,...t}=p;return(0,n.jsx)(s(),{href:x,"aria-label":m,className:b,...t,children:w})}let{type:f,...v}=p;return(0,n.jsx)("button",{type:f||"button","aria-label":m,className:b,...v,children:w})}},1237:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return c}});var n=a(5893),r=a(7294),s=a(1163),l=a(4967),i=a(6044),o=a(3454);function c(){let e=(0,s.useRouter)(),[t,a]=(0,r.useState)("login"),[c,u]=(0,r.useState)(""),[d,h]=(0,r.useState)(""),[m,x]=(0,r.useState)(!1),[p,g]=(0,r.useState)(!1),[b,w]=(0,r.useState)(null),[f,v]=(0,r.useState)(null),[y,_]=(0,r.useState)(!1),[j,N]=(0,r.useState)(""),[S,k]=(0,r.useState)(!1),[C,E]=(0,r.useState)(null);async function D(a){if(a.preventDefault(),w(null),v(null),!c||!d){w("Please enter your email and password.");return}x(!0);try{if("login"===t){var n,r;let{error:t}=await l.O.auth.signInWithPassword({email:c,password:d});if(t)throw t;let{data:a}=await l.O.auth.getUser();(null===(r=a.user)||void 0===r?void 0:null===(n=r.user_metadata)||void 0===n?void 0:n.must_change_password)?e.replace("/auth/reset"):e.replace("/feed")}else{let e=o.env.NEXT_PUBLIC_REDIRECT_ORIGIN||window.location.origin,{error:t}=await l.O.auth.signUp({email:c,password:d,options:{emailRedirectTo:"".concat(e,"/auth/callback")}});if(t)throw t;v("Check your email to confirm your account.")}}catch(e){w((null==e?void 0:e.message)||"Authentication failed")}finally{x(!1)}}async function O(){_(e=>!e),E(null),w(null)}async function P(e){if(e.preventDefault(),E(null),w(null),!j.trim()){E("Please enter your email or username.");return}k(!0);try{let e=await fetch("/api/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifier:j.trim()})}),t=await e.json();if(!e.ok||(null==t?void 0:t.ok)===!1)throw Error((null==t?void 0:t.message)||"Failed to reset password");E("If the account exists, a temporary password has been emailed.")}catch(e){E((null==e?void 0:e.message)||"Failed to reset password")}finally{k(!1)}}return(0,r.useEffect)(()=>{l.O.auth.getUser().then(t=>{let{data:a}=t;a.user&&e.replace("/feed")})},[e]),(0,n.jsx)("div",{className:"min-h-[70vh] flex items-center justify-center",children:(0,n.jsxs)("div",{className:"w-full max-w-md rounded-3xl border border-white/10 bg-white/5 backdrop-blur-md p-6 md:p-8 shadow-[0_8px_40px_rgba(0,0,0,0.25)]",children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold text-white/90 mb-1",children:"login"===t?"Log in":"Sign up"}),(0,n.jsx)("p",{className:"text-white/60 text-sm mb-6",children:"login"===t?"Welcome back! Enter your credentials below.":"Create your account using email and password."}),(0,n.jsxs)("form",{onSubmit:D,className:"space-y-4",children:[(0,n.jsxs)("label",{className:"block",children:[(0,n.jsx)("span",{className:"text-sm text-white/70",children:"Email"}),(0,n.jsx)("input",{type:"email",autoComplete:"email",value:c,onChange:e=>u(e.target.value),className:"mt-1 w-full rounded-xl bg-transparent border border-white/10 px-3 py-2 outline-none placeholder-white/40 text-white",placeholder:"you@example.com"})]}),(0,n.jsxs)("label",{className:"block",children:[(0,n.jsx)("span",{className:"text-sm text-white/70",children:"Password"}),(0,n.jsxs)("div",{className:"mt-1 relative",children:[(0,n.jsx)("input",{type:p?"text":"password",autoComplete:"login"===t?"current-password":"new-password",value:d,onChange:e=>h(e.target.value),className:"w-full rounded-xl bg-transparent border border-white/10 px-3 py-2 pr-10 outline-none placeholder-white/40 text-white",placeholder:"••••••••"}),(0,n.jsx)("button",{type:"button",onClick:()=>g(e=>!e),className:"absolute right-2 top-1/2 -translate-y-1/2 text-white/60 hover:text-white","aria-label":"Toggle password visibility",children:p?"\uD83D\uDE48":"\uD83D\uDC41️"})]})]}),b&&(0,n.jsx)("div",{className:"text-red-400 text-sm",children:b}),f&&(0,n.jsx)("div",{className:"text-white/80 text-sm",children:f}),(0,n.jsx)(i.Z,{type:"submit",disabled:m,variant:"primary",className:"w-full",children:m?"login"===t?"Logging in...":"Creating...":"login"===t?"Log in":"Sign up"})]}),(0,n.jsx)("div",{className:"mt-4 text-sm text-white/70",children:"login"===t?(0,n.jsxs)(n.Fragment,{children:["Don’t have an account?"," ",(0,n.jsx)("button",{className:"underline hover:no-underline",onClick:()=>{a("signup"),w(null)},children:"Sign up"})]}):(0,n.jsxs)(n.Fragment,{children:["Already have an account?"," ",(0,n.jsx)("button",{className:"underline hover:no-underline",onClick:()=>{a("login"),w(null)},children:"Log in"})]})}),(0,n.jsx)("div",{className:"mt-2 text-xs text-white/50",children:(0,n.jsx)("button",{type:"button",className:"underline hover:no-underline",onClick:O,children:"Forgot password?"})}),y&&(0,n.jsxs)("form",{onSubmit:P,className:"mt-4 space-y-3",children:[(0,n.jsxs)("label",{className:"block",children:[(0,n.jsx)("span",{className:"text-sm text-white/70",children:"Email or username"}),(0,n.jsx)("input",{type:"text",value:j,onChange:e=>N(e.target.value),className:"mt-1 w-full rounded-xl bg-transparent border border-white/10 px-3 py-2 outline-none placeholder-white/40 text-white",placeholder:"you@example.com or your_nickname"})]}),C&&(0,n.jsx)("div",{className:"text-white/80 text-sm",children:C}),(0,n.jsx)(i.Z,{type:"submit",disabled:S,variant:"primary",className:"w-full",children:S?"Sending...":"Reset Password"})]})]})})}}},function(e){e.O(0,[93,888,774,179],function(){return e(e.s=3236)}),_N_E=e.O()}]);